var J=Object.defineProperty,K=Object.defineProperties;var R=Object.getOwnPropertyDescriptors;var P=Object.getOwnPropertySymbols;var V=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var M=(r,l,a)=>l in r?J(r,l,{enumerable:!0,configurable:!0,writable:!0,value:a}):r[l]=a,$=(r,l)=>{for(var a in l||(l={}))V.call(l,a)&&M(r,a,l[a]);if(P)for(var a of P(l))X.call(l,a)&&M(r,a,l[a]);return r},B=(r,l)=>K(r,R(l));var u=(r,l,a)=>new Promise((b,o)=>{var m=c=>{try{i(a.next(c))}catch(d){o(d)}},w=c=>{try{i(a.throw(c))}catch(d){o(d)}},i=c=>c.done?b(c.value):Promise.resolve(c.value).then(m,w);i((a=a.apply(r,l)).next())});import{j as e,L as _,p as H,G as Q,i as N,n as y,h as F,o as v,a as U,J as D,K as I,b as W}from"./ui-libs-D7quiBqG.js";import{b as Y,r as x}from"./react-vendor-DREZjZ3y.js";import{u as Z,j as q,g as O}from"./index-vFyLetUi.js";const le=()=>{const r=Y(),l=Z(),[a,b]=x.useState([]),[o,m]=x.useState(!0),[w,i]=x.useState(null),[c,d]=x.useState(""),[j,z]=x.useState("all"),[t,h]=x.useState(null);x.useEffect(()=>{G()},[]);const G=()=>u(void 0,null,function*(){try{const s=yield q.getCurrentUser();if(s.user){if(i(s.user),s.user.role!=="admin"&&s.user.role!=="main_admin"){l.error("Access denied. Admin privileges required."),r("/");return}C()}}catch(s){console.error("Error checking auth:",s),l.error("Please login to continue"),r("/login")}}),C=()=>u(void 0,null,function*(){try{m(!0);const s=yield O.getAllEnquiries();b(s.enquiries||[])}catch(s){console.error("Error fetching enquiries:",s),l.error(s.message||"Failed to load enquiries")}finally{m(!1)}}),k=(s,n)=>u(void 0,null,function*(){try{yield O.updateEnquiryStatus(s,n),l.success("Enquiry status updated successfully!"),C(),t&&t.id===s&&h(B($({},t),{status:n}))}catch(g){console.error("Error updating status:",g),l.error(g.message||"Failed to update status")}}),f=s=>{switch(s){case"pending":return"bg-yellow-100 text-yellow-800";case"contacted":return"bg-blue-100 text-blue-800";case"booked":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},S=s=>{switch(s){case"pending":return e.jsx(I,{className:"w-4 h-4"});case"contacted":return e.jsx(D,{className:"w-4 h-4"});case"booked":return e.jsx(W,{className:"w-4 h-4"});case"cancelled":return e.jsx(U,{className:"w-4 h-4"});default:return e.jsx(I,{className:"w-4 h-4"})}},p=a.filter(s=>{var E,L,T,A;const n=((E=s.name)==null?void 0:E.toLowerCase().includes(c.toLowerCase()))||((L=s.email)==null?void 0:L.toLowerCase().includes(c.toLowerCase()))||((T=s.tripTitle)==null?void 0:T.toLowerCase().includes(c.toLowerCase()))||((A=s.tripLocation)==null?void 0:A.toLowerCase().includes(c.toLowerCase())),g=j==="all"||s.status===j;return n&&g});return o?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-purple-50",children:e.jsx(_,{className:"w-12 h-12 animate-spin text-blue-600"})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 pt-24 pb-8 px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-6 sm:mb-8",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl lg:text-4xl font-black bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent mb-2",children:"Manage Enquiries"}),e.jsx("p",{className:"text-sm sm:text-base text-gray-600",children:"View and manage trip enquiries from customers"})]}),e.jsxs("div",{className:"mb-4 sm:mb-6 grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(H,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 sm:w-5 sm:h-5"}),e.jsx("input",{type:"text",placeholder:"Search by name, email, trip...",value:c,onChange:s=>d(s.target.value),className:"w-full pl-9 sm:pl-10 pr-4 py-2 sm:py-3 text-sm sm:text-base border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all duration-300"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Q,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 sm:w-5 sm:h-5"}),e.jsxs("select",{value:j,onChange:s=>z(s.target.value),className:"w-full pl-9 sm:pl-10 pr-4 py-2 sm:py-3 text-sm sm:text-base border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none appearance-none bg-white",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"contacted",children:"Contacted"}),e.jsx("option",{value:"booked",children:"Booked"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-md border border-gray-200",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Total"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:a.length})]}),e.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-md border border-gray-200",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Pending"}),e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:a.filter(s=>s.status==="pending").length})]}),e.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-md border border-gray-200",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Contacted"}),e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:a.filter(s=>s.status==="contacted").length})]}),e.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-md border border-gray-200",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Booked"}),e.jsx("div",{className:"text-2xl font-bold text-green-600",children:a.filter(s=>s.status==="booked").length})]})]}),e.jsxs("div",{className:"bg-white rounded-xl sm:rounded-2xl shadow-xl border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"block sm:hidden",children:p.length===0?e.jsx("div",{className:"p-8 text-center text-gray-500",children:"No enquiries found"}):e.jsx("div",{className:"divide-y divide-gray-200",children:p.map(s=>e.jsxs("div",{className:"p-4 hover:bg-gray-50 cursor-pointer",onClick:()=>h(s),children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:s.name}),e.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-semibold flex items-center gap-1 ${f(s.status)}`,children:[S(s.status),s.status]})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:s.tripTitle}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(N,{className:"w-3 h-3"}),s.email]}),s.phone&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(y,{className:"w-3 h-3"}),s.phone]})]}),e.jsxs("div",{className:"mt-2 flex items-center gap-2 text-xs text-gray-500",children:[s.selectedMonth&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(F,{className:"w-3 h-3"}),s.selectedMonth]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(v,{className:"w-3 h-3"}),s.numberOfTravelers," travelers"]})]})]},s.id))})}),e.jsx("div",{className:"hidden sm:block overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 lg:px-6 py-3 lg:py-4 text-left text-xs sm:text-sm font-semibold text-gray-700",children:"Name"}),e.jsx("th",{className:"px-4 lg:px-6 py-3 lg:py-4 text-left text-xs sm:text-sm font-semibold text-gray-700",children:"Trip"}),e.jsx("th",{className:"px-4 lg:px-6 py-3 lg:py-4 text-left text-xs sm:text-sm font-semibold text-gray-700",children:"Email"}),e.jsx("th",{className:"px-4 lg:px-6 py-3 lg:py-4 text-left text-xs sm:text-sm font-semibold text-gray-700",children:"Phone"}),e.jsx("th",{className:"px-4 lg:px-6 py-3 lg:py-4 text-left text-xs sm:text-sm font-semibold text-gray-700",children:"Travelers"}),e.jsx("th",{className:"px-4 lg:px-6 py-3 lg:py-4 text-left text-xs sm:text-sm font-semibold text-gray-700",children:"Month"}),e.jsx("th",{className:"px-4 lg:px-6 py-3 lg:py-4 text-left text-xs sm:text-sm font-semibold text-gray-700",children:"Status"}),e.jsx("th",{className:"px-4 lg:px-6 py-3 lg:py-4 text-left text-xs sm:text-sm font-semibold text-gray-700",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:p.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"px-6 py-12 text-center text-gray-500",children:"No enquiries found"})}):p.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>h(s),children:[e.jsx("td",{className:"px-4 lg:px-6 py-3 lg:py-4",children:e.jsx("span",{className:"font-semibold text-gray-900 text-sm sm:text-base",children:s.name})}),e.jsxs("td",{className:"px-4 lg:px-6 py-3 lg:py-4",children:[e.jsx("div",{className:"text-sm text-gray-900 font-medium",children:s.tripTitle}),e.jsx("div",{className:"text-xs text-gray-500",children:s.tripLocation})]}),e.jsx("td",{className:"px-4 lg:px-6 py-3 lg:py-4 text-gray-700 text-sm sm:text-base",children:e.jsxs("a",{href:`mailto:${s.email}`,className:"hover:text-blue-600 flex items-center gap-1",children:[e.jsx(N,{className:"w-4 h-4"}),s.email]})}),e.jsx("td",{className:"px-4 lg:px-6 py-3 lg:py-4 text-gray-700 text-sm sm:text-base",children:s.phone?e.jsxs("a",{href:`tel:${s.phone}`,className:"hover:text-blue-600 flex items-center gap-1",children:[e.jsx(y,{className:"w-4 h-4"}),s.phone]}):e.jsx("span",{className:"text-gray-400",children:"-"})}),e.jsx("td",{className:"px-4 lg:px-6 py-3 lg:py-4 text-gray-700 text-sm sm:text-base",children:e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(v,{className:"w-4 h-4"}),s.numberOfTravelers||1]})}),e.jsx("td",{className:"px-4 lg:px-6 py-3 lg:py-4 text-gray-700 text-sm sm:text-base",children:s.selectedMonth||"-"}),e.jsx("td",{className:"px-4 lg:px-6 py-3 lg:py-4",children:e.jsxs("span",{className:`px-2 sm:px-3 py-1 rounded-full text-xs font-semibold flex items-center gap-1 w-fit ${f(s.status)}`,children:[S(s.status),s.status]})}),e.jsx("td",{className:"px-4 lg:px-6 py-3 lg:py-4",children:e.jsx("div",{className:"flex items-center gap-1 sm:gap-2",children:e.jsxs("select",{value:s.status,onChange:n=>{n.stopPropagation(),k(s.id,n.target.value)},className:"text-xs px-2 py-1 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",onClick:n=>n.stopPropagation(),children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"contacted",children:"Contacted"}),e.jsx("option",{value:"booked",children:"Booked"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})})})]},s.id))})]})})]})]}),t&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[200] flex items-center justify-center p-2 sm:p-4 overflow-y-auto",children:e.jsxs("div",{className:"bg-white rounded-xl sm:rounded-2xl shadow-2xl max-w-2xl w-full max-h-[95vh] overflow-y-auto my-4",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-4 sm:p-6 flex items-center justify-between z-10 shadow-sm",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"Enquiry Details"}),e.jsx("button",{onClick:()=>h(null),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors","aria-label":"Close",children:e.jsx(U,{className:"w-5 h-5 sm:w-6 sm:h-6"})})]}),e.jsxs("div",{className:"p-4 sm:p-6 space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-600 mb-1",children:"Name"}),e.jsx("p",{className:"text-sm sm:text-base text-gray-900 font-medium",children:t.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-600 mb-1",children:"Email"}),e.jsxs("a",{href:`mailto:${t.email}`,className:"text-sm sm:text-base text-blue-600 hover:underline flex items-center gap-1",children:[e.jsx(N,{className:"w-4 h-4"}),t.email]})]}),t.phone&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-600 mb-1",children:"Phone"}),e.jsxs("a",{href:`tel:${t.phone}`,className:"text-sm sm:text-base text-blue-600 hover:underline flex items-center gap-1",children:[e.jsx(y,{className:"w-4 h-4"}),t.phone]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-600 mb-1",children:"Status"}),e.jsxs("select",{value:t.status,onChange:s=>k(t.id,s.target.value),className:`mt-1 text-xs sm:text-sm px-3 py-2 border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none ${f(t.status)}`,children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"contacted",children:"Contacted"}),e.jsx("option",{value:"booked",children:"Booked"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-600 mb-1",children:"Trip"}),e.jsx("p",{className:"text-sm sm:text-base text-gray-900 font-medium",children:t.tripTitle}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:t.tripLocation}),e.jsxs("p",{className:"text-xs sm:text-sm text-gray-500 mt-1",children:["Price: ",t.tripPrice]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[t.selectedMonth&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-600 mb-1 flex items-center gap-1",children:[e.jsx(F,{className:"w-4 h-4"}),"Selected Month"]}),e.jsx("p",{className:"text-sm sm:text-base text-gray-900",children:t.selectedMonth})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-600 mb-1 flex items-center gap-1",children:[e.jsx(v,{className:"w-4 h-4"}),"Number of Travelers"]}),e.jsx("p",{className:"text-sm sm:text-base text-gray-900",children:t.numberOfTravelers||1})]})]}),t.message&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-600 mb-1 flex items-center gap-1",children:[e.jsx(D,{className:"w-4 h-4"}),"Message"]}),e.jsx("p",{className:"text-sm sm:text-base text-gray-900 bg-gray-50 p-3 rounded-lg",children:t.message})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-xs sm:text-sm text-gray-500",children:[e.jsxs("div",{children:[e.jsx("label",{className:"font-semibold",children:"Created"}),e.jsx("p",{children:t.createdAt?new Date(t.createdAt).toLocaleString():"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"font-semibold",children:"Updated"}),e.jsx("p",{children:t.updatedAt?new Date(t.updatedAt).toLocaleString():"-"})]})]})]})]})})]})};export{le as default};
