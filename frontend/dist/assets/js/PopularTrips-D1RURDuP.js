var f=(u,r,a)=>new Promise((p,d)=>{var h=i=>{try{c(a.next(i))}catch(n){d(n)}},m=i=>{try{c(a.throw(i))}catch(n){d(n)}},c=i=>i.done?p(i.value):Promise.resolve(i.value).then(h,m);c((a=a.apply(u,r)).next())});import{j as t,L as N}from"./ui-libs-D7quiBqG.js";import{e as L,r as l}from"./react-vendor-DREZjZ3y.js";import{t as A,l as P}from"./index-vFyLetUi.js";import{T as F}from"./TripCard-C6PeKURF.js";import{g as S,t as T}from"./tripUtils-DVFEfSkV.js";function R(){const[u]=L(),r=u.get("search")||"",[a,p]=l.useState("All"),[d,h]=l.useState([]),[m,c]=l.useState(["All"]),[i,n]=l.useState(!0),[w,g]=l.useState(!0);l.useEffect(()=>{b(),v()},[]),l.useEffect(()=>{if(r.trim()){const e=m.find(s=>s.toLowerCase().includes(r.toLowerCase())||r.toLowerCase().includes(s.toLowerCase()));e&&e!=="All"&&p(e)}},[r,m]);const b=()=>f(this,null,function*(){try{n(!0);const s=((yield A.getAllTrips()).trips||[]).filter(o=>o.status==="active"&&o.isPopular===!0);h(s)}catch(e){console.error("Error fetching trips:",e),h([])}finally{n(!1)}}),v=()=>f(this,null,function*(){try{g(!0);const e=yield P.getLocationFilters();c(e.filters||["All"])}catch(e){console.error("Error fetching filters:",e),c(["All","Meghalaya","Spiti Valley","Tirthan Valley","Himachal Pradesh","Shimla","Varanasi","Rishikesh","Kerala Backwaters"])}finally{g(!1)}}),y=l.useMemo(()=>{let e=d;return a!=="All"&&(e=e.filter(s=>{const o=S(s.location).toLowerCase().trim(),x=a.toLowerCase().trim();return o===x||o.includes(x)})),r.trim()&&(e=e.filter(s=>T(s,r))),e.sort((s,o)=>{if(s.isPopular&&!o.isPopular)return-1;if(!s.isPopular&&o.isPopular)return 1;const x=parseFloat((s.price||"0").replace(/[₹,]/g,""))||0,j=parseFloat((o.price||"0").replace(/[₹,]/g,""))||0;return x-j}),e},[a,d,r]);return t.jsx("div",{className:"min-h-screen bg-gradient-to-b from-gray-50 to-white py-12 md:py-16",children:t.jsxs("div",{className:"mx-auto w-full max-w-7xl px-4 sm:px-6 lg:px-8",children:[t.jsxs("div",{className:"mb-8 md:mb-12",children:[t.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[t.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-indigo-500 to-indigo-600 flex items-center justify-center text-white text-xl font-bold shadow-lg",children:"✈️"}),t.jsx("h1",{className:"text-3xl md:text-4xl lg:text-5xl font-bold text-gray-900",children:r.trim()?`Search Results for "${r}"`:"Popular Trips"})]}),t.jsx("p",{className:"text-gray-600 text-lg max-w-3xl",children:"Discover our most popular and highly-rated trips across India. These handpicked experiences are loved by travelers and come highly recommended."})]}),!w&&t.jsx("div",{className:"mb-8 flex flex-wrap items-center gap-3",children:m.map(e=>t.jsx("button",{type:"button",onClick:()=>p(e),className:`rounded-full border px-4 py-2 text-sm font-medium transition-all duration-300 whitespace-nowrap shadow-md hover:shadow-lg ${a===e?"border-[#017233] bg-gradient-to-br from-[#017233] to-[#01994d] text-white shadow-lg":"border-gray-200 text-gray-700 hover:border-[#017233] hover:text-[#017233] bg-white"}`,children:e},e))}),i?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsx(N,{className:"w-12 h-12 animate-spin text-[#017233]"})}):y.length>0?t.jsx("div",{className:"grid gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 items-stretch",children:y.map(e=>t.jsx(F,{trip:e},e.id))}):t.jsx("div",{className:"text-center py-12",children:t.jsx("p",{className:"text-gray-500 text-lg",children:r.trim()?`No trips found matching "${r}"`:a!=="All"?`No trips found for ${a}`:"No popular trips available at the moment."})})]})})}export{R as default};
