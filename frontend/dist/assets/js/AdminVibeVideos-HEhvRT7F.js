var y=(m,o,t)=>new Promise((d,x)=>{var h=a=>{try{i(t.next(a))}catch(c){x(c)}},b=a=>{try{i(t.throw(a))}catch(c){x(c)}},i=a=>a.done?d(a.value):Promise.resolve(a.value).then(h,b);i((t=t.apply(m,o)).next())});import{j as e,L as j,y as A,Y as U,T as Y,l as E}from"./ui-libs-D7quiBqG.js";import{b as I,r as l}from"./react-vendor-DREZjZ3y.js";import{u as L,j as P,v as N}from"./index-vFyLetUi.js";const K=()=>{const m=I(),o=L(),[t,d]=l.useState([]),[x,h]=l.useState(!0),[b,i]=l.useState(!1),[a,c]=l.useState(null),[g,v]=l.useState("");l.useEffect(()=>{w()},[]);const w=()=>y(void 0,null,function*(){try{const s=yield P.getCurrentUser();if(s.user){if(c(s.user),s.user.role!=="admin"&&s.user.role!=="main_admin"){o.error("Access denied. Admin privileges required."),m("/");return}V()}}catch(s){console.error("Error checking auth:",s),o.error("Please login to continue"),m("/login")}}),V=()=>y(void 0,null,function*(){try{h(!0);const s=yield N.getVibeVideosAdmin();d(s.videos||[])}catch(s){console.error("Error fetching videos:",s),o.error(s.message||"Failed to load vibe videos")}finally{h(!1)}}),p=s=>{if(!s)return null;if(!s.includes("youtube.com")&&!s.includes("youtu.be"))return s.length===11?s:null;const n=/(?:youtube\.com\/(?:watch\?v=|shorts\/|embed\/)|youtu\.be\/)([^#&?\/\s]{11})/,r=s.match(n);return r&&r[1]&&r[1].length===11?r[1]:null},f=()=>{if(!g.trim()){o.error("Please enter a YouTube video link");return}const s=p(g.trim());if(!s){o.error("Invalid YouTube URL. Please enter a valid YouTube or YouTube Shorts link");return}if(t.find(u=>p(u.youtubeUrl)===s)){o.error("This video is already added");return}const r={id:Date.now(),youtubeUrl:g.trim(),title:`Video ${t.length+1}`,isTall:!0};d([...t,r]),v(""),o.success("Video added successfully")},S=s=>{d(t.filter((n,r)=>r!==s)),o.success("Video removed")},T=()=>y(void 0,null,function*(){try{i(!0),yield N.updateVibeVideos(t),o.success("Vibe videos updated successfully")}catch(s){console.error("Error saving videos:",s),o.error(s.message||"Failed to save vibe videos")}finally{i(!1)}}),k=s=>{s.key==="Enter"&&f()};return e.jsx("div",{className:"min-h-screen bg-gradient-to-b from-gray-50 to-white py-8",children:e.jsxs("div",{className:"mx-auto w-full max-w-4xl px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-purple-500 to-pink-600 flex items-center justify-center text-white text-xl font-bold shadow-lg",children:"ðŸŽ¬"}),e.jsx("h1",{className:"text-3xl md:text-4xl lg:text-5xl font-bold text-gray-900",children:"Manage Vibe Videos"})]}),e.jsx("p",{className:"text-gray-600 text-lg max-w-3xl",children:'Add YouTube Short video links to display in the "Vibe with Us" section. Videos will be displayed in a grid layout on the homepage.'})]}),x?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(j,{className:"w-12 h-12 animate-spin text-[#017233]"})}):e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Add YouTube Short Video Link"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:g,onChange:s=>v(s.target.value),onKeyPress:k,placeholder:"Enter YouTube or YouTube Shorts URL (e.g., https://youtube.com/shorts/abc123 or https://youtu.be/abc123)",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#017233] focus:border-transparent"}),e.jsxs("button",{onClick:f,className:"px-4 py-2 bg-[#017233] text-white rounded-lg hover:bg-[#015a28] transition-colors flex items-center gap-2",children:[e.jsx(A,{className:"w-4 h-4"}),"Add"]})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Supports YouTube URLs (youtube.com, youtu.be) and YouTube Shorts links"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Current Videos (",t.length,")"]}),t.length>0?e.jsx("div",{className:"space-y-3",children:t.map((s,n)=>{const r=p(s.youtubeUrl),u=r?`https://img.youtube.com/vi/${r}/mqdefault.jpg`:null;return e.jsxs("div",{className:"flex items-center gap-4 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[u&&e.jsx("img",{src:u,alt:"Video thumbnail",className:"w-24 h-16 object-cover rounded"}),!u&&e.jsx("div",{className:"w-24 h-16 bg-gray-200 rounded flex items-center justify-center",children:e.jsx(U,{className:"w-6 h-6 text-gray-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:s.youtubeUrl}),r&&e.jsxs("p",{className:"text-xs text-gray-500",children:["ID: ",r]})]}),e.jsx("button",{onClick:()=>S(n),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Remove video",children:e.jsx(Y,{className:"w-4 h-4"})})]},n)})}):e.jsx("p",{className:"text-gray-500 text-sm",children:"No videos added yet. Add your first video above."})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:T,disabled:b,className:"px-6 py-3 bg-gradient-to-r from-[#017233] to-[#01994d] text-white rounded-lg hover:shadow-lg transition-all flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:b?e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"w-5 h-5 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"w-5 h-5"}),"Save Videos"]})})})]})]})})};export{K as default};
