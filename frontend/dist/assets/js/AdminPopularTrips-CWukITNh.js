var W=Object.defineProperty,Y=Object.defineProperties;var Z=Object.getOwnPropertyDescriptors;var O=Object.getOwnPropertySymbols;var I=Object.prototype.hasOwnProperty,ee=Object.prototype.propertyIsEnumerable;var K=(r,t,a)=>t in r?W(r,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):r[t]=a,j=(r,t)=>{for(var a in t||(t={}))I.call(t,a)&&K(r,a,t[a]);if(O)for(var a of O(t))ee.call(t,a)&&K(r,a,t[a]);return r},y=(r,t)=>Y(r,Z(t));var d=(r,t,a)=>new Promise((u,p)=>{var f=l=>{try{m(a.next(l))}catch(x){p(x)}},S=l=>{try{m(a.throw(l))}catch(x){p(x)}},m=l=>l.done?u(l.value):Promise.resolve(l.value).then(f,S);m((a=a.apply(r,t)).next())});import{j as e,N as se,y as te,X as ae,L as N,l as re,p as le,x as R,O as $}from"./ui-libs-BFSs07BO.js";import{b as ie,r as n}from"./react-vendor-3BC6cITN.js";import{u as oe,g as ne,l as G,t as H}from"./index-DCzZaeNN.js";const ge=()=>{const r=ie(),t=oe(),[a,u]=n.useState([]),[p,f]=n.useState(!0),[S,m]=n.useState(null),[l,x]=n.useState(""),[b,P]=n.useState({}),[c,v]=n.useState([]),[ce,T]=n.useState(!0),[C,L]=n.useState(!1),[h,k]=n.useState(""),[w,X]=n.useState(!1);n.useEffect(()=>{_()},[]);const _=()=>d(void 0,null,function*(){try{const s=yield ne.getCurrentUser();if(s.user){if(m(s.user),s.user.role!=="admin"&&s.user.role!=="main_admin"){t.error("Access denied. Admin privileges required."),r("/");return}Q(),z()}}catch(s){console.error("Error checking auth:",s),t.error("Please login to continue"),r("/login")}}),z=()=>d(void 0,null,function*(){try{T(!0);const s=yield G.getLocationFiltersAdmin();v(s.filters||[])}catch(s){console.error("Error fetching filters:",s),t.error(s.message||"Failed to load location filters")}finally{T(!1)}}),E=()=>{if(!h.trim()){t.error("Please enter a filter name");return}if(c.includes(h.trim())){t.error("This filter already exists");return}if(h.trim()==="All"){t.error("'All' filter is always included and cannot be added");return}v([...c,h.trim()]),k("")},B=s=>{if(s==="All"){t.error("'All' filter cannot be removed");return}v(c.filter(o=>o!==s))},D=()=>d(void 0,null,function*(){try{L(!0),yield G.updateLocationFilters(c),t.success("Location filters updated successfully")}catch(s){console.error("Error saving filters:",s),t.error(s.message||"Failed to save location filters")}finally{L(!1)}}),J=s=>{s.key==="Enter"&&E()},Q=()=>d(void 0,null,function*(){try{f(!0);const o=((yield H.getAllTripsAdmin()).trips||[]).filter(i=>i.status==="active");u(o)}catch(s){console.error("Error fetching trips:",s),t.error(s.message||"Failed to load trips")}finally{f(!1)}}),U=(s,o)=>d(void 0,null,function*(){try{P(g=>y(j({},g),{[s]:!0}));const i=a.find(g=>g.id===s);if(!i)return;const V=yield H.updateTrip(s,y(j({},i),{isPopular:!o}));u(g=>g.map(M=>M.id===s?V:M)),t.success(`Trip ${o?"removed from":"added to"} popular trips`)}catch(i){console.error("Error updating trip:",i),t.error(i.message||"Failed to update trip")}finally{P(i=>y(j({},i),{[s]:!1}))}}),q=a.filter(s=>{var o,i;return((o=s.title)==null?void 0:o.toLowerCase().includes(l.toLowerCase()))||((i=s.location)==null?void 0:i.toLowerCase().includes(l.toLowerCase()))}),F=q.filter(s=>s.isPopular),A=q.filter(s=>!s.isPopular);return e.jsx("div",{className:"min-h-screen bg-gradient-to-b from-gray-50 to-white py-8",children:e.jsxs("div",{className:"mx-auto w-full max-w-7xl px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-yellow-500 to-orange-600 flex items-center justify-center text-white text-xl font-bold shadow-lg",children:"â­"}),e.jsx("h1",{className:"text-3xl md:text-4xl lg:text-5xl font-bold text-gray-900",children:"Manage Popular Trips"})]}),e.jsx("p",{className:"text-gray-600 text-lg max-w-3xl",children:'Select which trips should appear in the "Popular Trips" section on the homepage. Only trips marked as popular will be displayed to users.'})]}),e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(se,{className:"w-6 h-6 text-blue-600"}),e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Location Filters"})]}),e.jsx("button",{onClick:()=>X(!w),className:"text-sm text-[#017233] hover:underline font-medium",children:w?"Hide":"Manage Filters"})]}),w&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Add New Location Filter"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:h,onChange:s=>k(s.target.value),onKeyPress:J,placeholder:"Enter location name (e.g., Goa, Manali)",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#017233] focus:border-transparent"}),e.jsxs("button",{onClick:E,className:"px-4 py-2 bg-[#017233] text-white rounded-lg hover:bg-[#015a28] transition-colors flex items-center gap-2",children:[e.jsx(te,{className:"w-4 h-4"}),"Add"]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["Current Filters (",c.length,")"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:c.map((s,o)=>e.jsxs("div",{className:`flex items-center gap-2 px-3 py-1.5 rounded-full border text-sm transition-all ${s==="All"?"bg-gradient-to-br from-[#017233] to-[#01994d] text-white border-[#017233]":"bg-gray-50 text-gray-700 border-gray-300 hover:bg-gray-100"}`,children:[e.jsx("span",{className:"font-medium",children:s}),s!=="All"&&e.jsx("button",{onClick:()=>B(s),className:"ml-1 hover:bg-red-100 rounded-full p-0.5 transition-colors",title:"Remove filter",children:e.jsx(ae,{className:"w-3 h-3 text-red-600"})})]},o))})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4",children:e.jsxs("p",{className:"text-xs text-blue-800",children:[e.jsx("strong",{children:"Note:"}),' The "All" filter is always included and cannot be removed.']})}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:D,disabled:C,className:"px-4 py-2 bg-gradient-to-r from-[#017233] to-[#01994d] text-white rounded-lg hover:shadow-lg transition-all flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:C?e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"w-4 h-4 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(re,{className:"w-4 h-4"}),"Save Filters"]})})})]})]})}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"relative",children:[e.jsx(le,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search trips by title or location...",value:l,onChange:s=>x(s.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-[#017233] focus:border-transparent"})]})}),p?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(N,{className:"w-12 h-12 animate-spin text-[#017233]"})}):e.jsxs(e.Fragment,{children:[F.length>0&&e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(R,{className:"w-6 h-6 text-yellow-500 fill-yellow-500"}),e.jsxs("h2",{className:"text-2xl font-bold text-gray-900",children:["Popular Trips (",F.length,")"]})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden",children:e.jsx("div",{className:"divide-y divide-gray-200",children:F.map(s=>e.jsxs("div",{className:"p-4 hover:bg-gray-50 transition-colors flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.jsx("img",{src:s.imageUrl||s.image||"https://images.unsplash.com/photo-1501594907352-04cda38ebc29?auto=format&fit=crop&w=900&q=60",alt:s.title,className:"w-20 h-20 object-cover rounded-lg"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:s.title}),e.jsx("p",{className:"text-sm text-gray-600",children:s.location}),e.jsx("p",{className:"text-sm font-medium text-[#017233] mt-1",children:s.price})]})]}),e.jsx("button",{onClick:()=>U(s.id,s.isPopular),disabled:b[s.id],className:"flex items-center gap-2 px-4 py-2 bg-yellow-100 text-yellow-700 rounded-lg hover:bg-yellow-200 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:b[s.id]?e.jsx(N,{className:"w-4 h-4 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(R,{className:"w-4 h-4 fill-yellow-500"}),e.jsx("span",{className:"font-medium",children:"Popular"})]})})]},s.id))})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx($,{className:"w-6 h-6 text-gray-400"}),e.jsxs("h2",{className:"text-2xl font-bold text-gray-900",children:["All Trips (",A.length,")"]})]}),A.length>0?e.jsx("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden",children:e.jsx("div",{className:"divide-y divide-gray-200",children:A.map(s=>e.jsxs("div",{className:"p-4 hover:bg-gray-50 transition-colors flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.jsx("img",{src:s.imageUrl||s.image||"https://images.unsplash.com/photo-1501594907352-04cda38ebc29?auto=format&fit=crop&w=900&q=60",alt:s.title,className:"w-20 h-20 object-cover rounded-lg"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:s.title}),e.jsx("p",{className:"text-sm text-gray-600",children:s.location}),e.jsx("p",{className:"text-sm font-medium text-[#017233] mt-1",children:s.price})]})]}),e.jsx("button",{onClick:()=>U(s.id,s.isPopular),disabled:b[s.id],className:"flex items-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:b[s.id]?e.jsx(N,{className:"w-4 h-4 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx($,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"Add to Popular"})]})})]},s.id))})}):e.jsx("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 p-8 text-center",children:e.jsx("p",{className:"text-gray-500 text-lg",children:l?"No trips found matching your search.":"No trips available."})})]})]})]})})};export{ge as default};
