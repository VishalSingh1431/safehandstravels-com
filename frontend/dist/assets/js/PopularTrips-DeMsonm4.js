var g=(f,a,i)=>new Promise((u,m)=>{var h=o=>{try{n(i.next(o))}catch(d){m(d)}},p=o=>{try{n(i.throw(o))}catch(d){m(d)}},n=o=>o.done?u(o.value):Promise.resolve(o.value).then(h,p);n((i=i.apply(f,a)).next())});import{j as r,L as C}from"./ui-libs-CdhAi6Tc.js";import{e as A,r as l}from"./react-vendor-3BC6cITN.js";import{t as P,l as F}from"./index-CRsNqYr4.js";import{T}from"./TripCard-BbFQrgKL.js";import"./imageOptimizer-DTru_mI7.js";function V(){const[f]=A(),a=f.get("search")||"",[i,u]=l.useState("All"),[m,h]=l.useState([]),[p,n]=l.useState(["All"]),[o,d]=l.useState(!0),[j,w]=l.useState(!0);l.useEffect(()=>{L(),N()},[]),l.useEffect(()=>{if(a.trim()){const e=p.find(t=>t.toLowerCase().includes(a.toLowerCase())||a.toLowerCase().includes(t.toLowerCase()));e&&e!=="All"&&u(e)}},[a,p]);const L=()=>g(this,null,function*(){try{d(!0);const t=((yield P.getAllTrips()).trips||[]).filter(s=>s.status==="active"&&s.isPopular===!0);h(t)}catch(e){console.error("Error fetching trips:",e),h([])}finally{d(!1)}}),N=()=>g(this,null,function*(){try{w(!0);const e=yield F.getLocationFilters();n(e.filters||["All"])}catch(e){console.error("Error fetching filters:",e),n(["All","Meghalaya","Spiti Valley","Tirthan Valley","Himachal Pradesh","Shimla","Varanasi","Rishikesh","Kerala Backwaters"])}finally{w(!1)}}),y=l.useMemo(()=>{let e=m;if(i!=="All"&&(e=e.filter(t=>{const s=(t.location||"").toLowerCase().trim(),c=i.toLowerCase().trim();return s===c||s.includes(c)})),a.trim()){const t=a.toLowerCase();e=e.filter(s=>{var c,x,b,v;return((c=s.title)==null?void 0:c.toLowerCase().includes(t))||((x=s.location)==null?void 0:x.toLowerCase().includes(t))||((b=s.subtitle)==null?void 0:b.toLowerCase().includes(t))||((v=s.intro)==null?void 0:v.toLowerCase().includes(t))})}return e.sort((t,s)=>{if(t.isPopular&&!s.isPopular)return-1;if(!t.isPopular&&s.isPopular)return 1;const c=parseFloat((t.price||"0").replace(/[₹,]/g,""))||0,x=parseFloat((s.price||"0").replace(/[₹,]/g,""))||0;return c-x}),e},[i,m,a]);return r.jsx("div",{className:"min-h-screen bg-gradient-to-b from-gray-50 to-white py-12 md:py-16",children:r.jsxs("div",{className:"mx-auto w-full max-w-7xl px-4 sm:px-6 lg:px-8",children:[r.jsxs("div",{className:"mb-8 md:mb-12",children:[r.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[r.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-indigo-500 to-indigo-600 flex items-center justify-center text-white text-xl font-bold shadow-lg",children:"✈️"}),r.jsx("h1",{className:"text-3xl md:text-4xl lg:text-5xl font-bold text-gray-900",children:a.trim()?`Search Results for "${a}"`:"Popular Trips"})]}),r.jsx("p",{className:"text-gray-600 text-lg max-w-3xl",children:"Discover our most popular and highly-rated trips across India. These handpicked experiences are loved by travelers and come highly recommended."})]}),!j&&r.jsx("div",{className:"mb-8 flex flex-wrap items-center gap-3",children:p.map(e=>r.jsx("button",{type:"button",onClick:()=>u(e),className:`rounded-full border px-4 py-2 text-sm font-medium transition-all duration-300 whitespace-nowrap shadow-md hover:shadow-lg ${i===e?"border-[#017233] bg-gradient-to-br from-[#017233] to-[#01994d] text-white shadow-lg":"border-gray-200 text-gray-700 hover:border-[#017233] hover:text-[#017233] bg-white"}`,children:e},e))}),o?r.jsx("div",{className:"flex items-center justify-center py-12",children:r.jsx(C,{className:"w-12 h-12 animate-spin text-[#017233]"})}):y.length>0?r.jsx("div",{className:"grid gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 items-stretch",children:y.map(e=>r.jsx(T,{trip:e},e.id))}):r.jsx("div",{className:"text-center py-12",children:r.jsx("p",{className:"text-gray-500 text-lg",children:a.trim()?`No trips found matching "${a}"`:i!=="All"?`No trips found for ${i}`:"No popular trips available at the moment."})})]})})}export{V as default};
